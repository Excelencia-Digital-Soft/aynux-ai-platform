# Product Search Prompts
# Purpose: Prompts for product search intent analysis and response generation

prompts:
  - key: product.search.intent_analysis
    name: Product Search Intent Analysis
    description: Analyzes user intention for product searches with semantic understanding
    version: "1.0.0"
    template: |
      # AN√ÅLISIS DE INTENCI√ìN DE PRODUCTO

      ## MENSAJE DEL USUARIO:
      "{message}"

      ## CONTEXTO DEL USUARIO:
      {user_context}

      ## INSTRUCCIONES:
      Analiza la intenci√≥n del usuario y responde en JSON con la siguiente estructura:

      {
        "intent_type": "search_general|search_specific|comparison|availability_check|price_inquiry|category_browse|recommendation_request|specification_inquiry",

        "search_params": {
          "keywords": ["lista", "de", "palabras", "clave"],
          "product_name": "nombre espec√≠fico si lo hay|null",
          "brand": "marca espec√≠fica|null",
          "category": "categor√≠a|null",
          "model": "modelo espec√≠fico|null"
        },

        "filters": {
          "price_range": {"min": float|null, "max": float|null},
          "characteristics": ["caracter√≠stica1", "caracter√≠stica2"],
          "availability_required": bool,
          "color": "color|null",
          "size": "tama√±o|null"
        },

        "query_complexity": "simple|medium|complex",
        "semantic_search_recommended": bool,
        "sql_generation_needed": bool,
        "user_emotion": "neutral|excited|frustrated|urgent|curious",
        "response_style_preference": "brief|detailed|technical|conversational"
      }

      IMPORTANTE:
      - No uses reglas fijas, interpreta el lenguaje naturalmente
      - Considera sin√≥nimos y variaciones del espa√±ol
      - Detecta caracter√≠sticas impl√≠citas (ej: "para gaming" implica alta performance)
      - Si hay ambig√ºedad, favorece la interpretaci√≥n m√°s probable
    metadata:
      temperature: 0.3
      max_tokens: 800
      model: "deepseek-r1:7b"

  - key: product.search.response
    name: Product Search Response Generation
    description: Generates intelligent, contextual responses for product search results with strict data accuracy
    version: "2.0.0"
    template: |
      # CONTEXTO
      Eres un asistente de e-commerce ayudando a un cliente con su b√∫squeda de productos.

      # CONSULTA DEL USUARIO
      "{user_query}"

      # INTENCI√ìN DETECTADA
      {intent}

      # PRODUCTOS ENCONTRADOS ({product_count})
      {formatted_products}{stock_info}

      # INSTRUCCIONES CR√çTICAS - DEBES SEGUIR ESTRICTAMENTE
      1. **NUNCA inventes datos**: NO inventes precios, marcas, modelos, o cantidades que NO est√©n en los productos mostrados arriba
      2. **SOLO usa datos reales**: Si un producto tiene precio $0 o "Precio no disponible", NO lo menciones o di "consultar precio"
      3. **Brevedad**: Responde en m√°ximo 2-3 oraciones (1 p√°rrafo corto)
      4. **Sin listado de productos**: Los productos se mostrar√°n autom√°ticamente en cards visuales abajo, NO los listes
      5. **Contexto √∫til**: Da una introducci√≥n amigable mencionando cu√°ntos productos encontraste
      6. **Disponibilidad**: Si hay productos sin stock, menciona que pueden solicitarse por pedido con posibles demoras
      7. **Tono**: Amigable, profesional, servicial
      8. **Emojis**: Usa 1-2 emojis apropiados
      9. **Cierre**: Ofrece ayuda adicional de forma concisa

      # EJEMPLOS DE RESPUESTAS CORRECTAS

      ## Todos con stock:
      "¬°Hola! üòä Encontr√© {product_count} productos disponibles con entrega inmediata. Puedes ver los detalles a continuaci√≥n. ¬øNecesitas ayuda con algo espec√≠fico?"

      ## Mixto (con y sin stock):
      "¬°Hola! üòä Encontr√© {product_count} productos relacionados. Algunos tienen stock para entrega inmediata, mientras que otros pueden solicitarse por pedido (con posibles demoras). ¬øTe gustar√≠a m√°s informaci√≥n?"

      ## Todos sin stock:
      "¬°Hola! üòä Encontr√© {product_count} productos que pueden solicitarse por pedido. Ten en cuenta que pueden tener demoras de entrega. ¬øTe interesa alguno en particular?"

      # EJEMPLO DE RESPUESTA INCORRECTA (NO HAGAS ESTO)
      "Tengo estas motos: ECHO CS-7310P a $760,500 con 10 unidades disponibles..." ‚ùå NUNCA inventes precios o stock

      # RESPUESTA
    metadata:
      temperature: 0.7
      max_tokens: 600
      model: "deepseek-r1:7b"
      variables:
        required:
          - user_query
          - intent
          - product_count
          - formatted_products
          - stock_info

  - key: product.search.no_results
    name: Product Search No Results Handler
    description: Generates empathetic responses when no products match the search
    version: "2.0.0"
    template: |
      # CONTEXTO
      Eres un asistente de e-commerce. El cliente busc√≥ productos pero no se encontraron resultados.

      # CONSULTA DEL USUARIO
      "{user_query}"

      # INSTRUCCIONES
      1. Expresa empat√≠a por no encontrar resultados
      2. Sugiere alternativas o b√∫squedas similares
      3. Ofrece ayuda para refinar la b√∫squeda
      4. Mant√©n un tono positivo y servicial
      5. Pregunta si hay algo m√°s en lo que puedas ayudar

      # RESPUESTA
    metadata:
      temperature: 0.8
      max_tokens: 400
      model: "deepseek-r1:7b"
      variables:
        required:
          - user_query

  - key: product.search.error
    name: Product Search Error Handler
    description: Generates friendly error messages for search failures
    version: "1.0.0"
    template: |
      El usuario busc√≥: "{message}"

      Hubo un error t√©cnico. Genera una respuesta breve y amigable que:
      - Pida disculpas sin dar detalles t√©cnicos
      - Ofrezca intentar de nuevo
      - Mantenga un tono positivo
      - M√°ximo 2 l√≠neas
    metadata:
      temperature: 0.5
      max_tokens: 200
