# Pharmacy Fallback Templates
# Se usan SOLO cuando el LLM no responde o hay timeout
# Backup para garantizar que siempre hay una respuesta

prompts:
  # =========================================================================
  # SALUDOS Y BIENVENIDA
  # =========================================================================

  - key: pharmacy.fallback.greeting
    name: Greeting Fallback
    description: Saludo cuando LLM falla
    version: "1.0.0"
    template: |
      Hola! Soy el asistente virtual de {pharmacy_name}.

      Puedo ayudarte con:
      ‚Ä¢ Consulta de deuda
      ‚Ä¢ Link de pago
      ‚Ä¢ Informaci√≥n de la farmacia

      ¬øEn qu√© puedo asistirte?
    metadata:
      variables:
        required:
          - pharmacy_name

  - key: pharmacy.fallback.greeting_identified
    name: Greeting Identified Customer
    description: Saludo a cliente identificado
    version: "1.0.0"
    template: |
      Hola {customer_name}! Soy el asistente de {pharmacy_name}.

      ¬øEn qu√© puedo ayudarte hoy?
    metadata:
      variables:
        required:
          - customer_name
          - pharmacy_name

  # =========================================================================
  # SOLICITUD DE DNI
  # =========================================================================

  - key: pharmacy.fallback.request_dni
    name: Request DNI Fallback
    description: Solicitud de DNI cuando LLM falla
    version: "1.0.0"
    template: |
      Para continuar, necesito verificar tu identidad.
      Por favor ingresa tu n√∫mero de DNI:
    metadata:
      variables:
        required: []

  - key: pharmacy.fallback.request_dni_welcome
    name: Welcome with DNI Request
    description: Bienvenida solicitando DNI
    version: "1.0.0"
    template: |
      Hola! Soy el asistente virtual de {pharmacy_name}.

      Para poder ayudarte con tu consulta de deuda, necesito verificar tu identidad.

      Por favor, ingresa tu n√∫mero de DNI:
    metadata:
      variables:
        required:
          - pharmacy_name

  - key: pharmacy.fallback.request_name
    name: Request Name Fallback
    description: Solicitud de nombre cuando LLM falla
    version: "1.0.0"
    template: |
      Encontr√© un registro con ese DNI.

      Por motivos de seguridad, necesito que confirmes el nombre de la persona.
      Por favor, escribe el nombre completo:
    metadata:
      variables:
        required: []

  # =========================================================================
  # ERRORES Y VALIDACIONES
  # =========================================================================

  - key: pharmacy.fallback.dni_not_found
    name: DNI Not Found Fallback
    description: DNI no encontrado
    version: "1.0.0"
    template: |
      No encontr√© ning√∫n cliente con el DNI {dni} en nuestro sistema.

      Por favor verifica el n√∫mero e intenta de nuevo, o contacta a {pharmacy_phone}.
    metadata:
      variables:
        required:
          - dni
          - pharmacy_phone

  - key: pharmacy.fallback.name_mismatch
    name: Name Mismatch Fallback
    description: Nombre no coincide
    version: "1.0.0"
    template: |
      El nombre ingresado no coincide con nuestros registros.

      Por favor, intenta de nuevo escribiendo el nombre exacto.
      Intento {attempt} de 3.
    metadata:
      variables:
        required:
          - attempt

  # =========================================================================
  # INTENCIONES DESCONOCIDAS
  # =========================================================================

  - key: pharmacy.fallback.unknown_intent
    name: Unknown Intent Fallback
    description: Intent desconocido
    version: "1.0.0"
    template: |
      No pude entender tu mensaje.

      Puedo ayudarte con:
      ‚Ä¢ Consulta de deuda - "quiero ver mi deuda"
      ‚Ä¢ Pagar - "quiero pagar"
      ‚Ä¢ Info de farmacia - "horarios", "direcci√≥n"

      ¬øQu√© necesitas?
    metadata:
      variables:
        required: []

  - key: pharmacy.fallback.out_of_scope
    name: Out of Scope Fallback
    description: Consulta fuera de alcance
    version: "1.0.0"
    template: |
      Esa consulta est√° fuera de mi alcance.

      Solo puedo ayudarte con deudas y pagos.
      Para otros temas, contacta a {pharmacy_phone}.
    metadata:
      variables:
        required:
          - pharmacy_phone

  # =========================================================================
  # SELECCI√ìN DE PERSONAS
  # =========================================================================

  - key: pharmacy.fallback.ask_own_or_other
    name: Ask Own or Other Person
    description: Preguntar si deuda propia u otra persona
    version: "1.0.0"
    template: |
      Hola {customer_name}!

      ¬øDeseas consultar tu propia deuda o la de otra persona?

      Responde:
      ‚Ä¢ *Propia* - Para consultar tu deuda
      ‚Ä¢ *Otra persona* - Para consultar la deuda de un familiar o conocido
    metadata:
      variables:
        required:
          - customer_name

  - key: pharmacy.fallback.person_list
    name: Person Selection List
    description: Lista de personas registradas
    version: "1.0.0"
    template: |
      Hola! Soy el asistente de {pharmacy_name}.

      Tengo registradas las siguientes personas para este n√∫mero:

      {person_list}

      Por favor, indica el n√∫mero de la persona o escribe su nombre:
    metadata:
      variables:
        required:
          - pharmacy_name
          - person_list

  # =========================================================================
  # DESPEDIDAS Y AGRADECIMIENTOS
  # =========================================================================

  - key: pharmacy.fallback.farewell
    name: Farewell Fallback
    description: Despedida
    version: "1.0.0"
    template: |
      Gracias por contactar a {pharmacy_name}.

      Recuerda que para:
      ‚Ä¢ Deudas: puedes escribirme directamente
      ‚Ä¢ Otros temas: {pharmacy_phone}

      ¬°Que tengas un excelente d√≠a!
    metadata:
      variables:
        required:
          - pharmacy_name
          - pharmacy_phone

  - key: pharmacy.fallback.thanks
    name: Thanks Response Fallback
    description: Respuesta a agradecimiento
    version: "1.0.0"
    template: |
      ¬°De nada! Es un placer ayudarte.

      No dudes en escribirme si necesitas consultar tu deuda o generar un link de pago.
    metadata:
      variables:
        required: []

  - key: pharmacy.fallback.cancelled
    name: Cancelled Operation
    description: Operaci√≥n cancelada
    version: "1.0.0"
    template: |
      Entendido, la operaci√≥n ha sido cancelada.

      ¬øHay algo m√°s en que pueda ayudarte?
    metadata:
      variables:
        required: []

  # =========================================================================
  # CONFIRMACIONES SIMPLES
  # =========================================================================

  - key: pharmacy.fallback.processing
    name: Processing Message
    description: Mensaje mientras se procesa
    version: "1.0.0"
    template: |
      Consultando tu informaci√≥n...
      Por favor espera unos segundos.
    metadata:
      variables:
        required: []

  - key: pharmacy.fallback.no_debt
    name: No Debt Found
    description: Cliente sin deuda
    version: "1.0.0"
    template: |
      {customer_name}, no tienes deudas pendientes.

      ¬øHay algo m√°s en que pueda ayudarte?
    metadata:
      variables:
        required:
          - customer_name

  # =========================================================================
  # RESOLUCI√ìN DE PERSONAS (PersonResolutionNode)
  # =========================================================================

  - key: pharmacy.fallback.request_dni_for_other
    name: Request DNI for Other Person
    description: Solicitar DNI para otra persona
    version: "1.0.0"
    template: |
      Para consultar la deuda de otra persona necesito verificar los datos.
      Por favor, ingresa el n√∫mero de DNI de la persona:
    metadata:
      variables:
        required: []

  - key: pharmacy.fallback.proceed_with_customer
    name: Proceed With Customer
    description: Confirmar cliente seleccionado
    version: "1.0.0"
    template: |
      Perfecto {customer_name}, consultando tu deuda...
    metadata:
      variables:
        required:
          - customer_name

  - key: pharmacy.fallback.ambiguous_own_other
    name: Ambiguous Own Or Other Response
    description: Respuesta ambigua a propia/otra
    version: "1.0.0"
    template: |
      No entend√≠ tu respuesta. Por favor indica:
      1. Consultar mi propia deuda
      2. Consultar deuda de otra persona
    metadata:
      variables:
        required: []

  - key: pharmacy.fallback.no_phone_error
    name: No Phone Error
    description: Error sin tel√©fono disponible
    version: "1.0.0"
    template: |
      No pude identificar tu n√∫mero de tel√©fono.
      Por favor contacta directamente a {pharmacy_phone}.
    metadata:
      variables:
        required:
          - pharmacy_phone

  - key: pharmacy.fallback.no_pharmacy_error
    name: No Pharmacy Error
    description: Error sin farmacia identificada
    version: "1.0.0"
    template: |
      Lo siento, no pude identificar la farmacia.
      Por favor contacta directamente a la farmacia.
    metadata:
      variables:
        required: []

  # =========================================================================
  # SELECCI√ìN DE PERSONAS (PersonSelectionNode)
  # =========================================================================

  - key: pharmacy.fallback.add_new_person
    name: Add New Person
    description: Agregar nueva persona
    version: "1.0.0"
    template: |
      Perfecto, vamos a registrar una nueva persona.
      Por favor, ingresa el n√∫mero de DNI:
    metadata:
      variables:
        required: []

  - key: pharmacy.fallback.selection_confirmed
    name: Selection Confirmed
    description: Selecci√≥n de persona confirmada
    version: "1.0.0"
    template: |
      Perfecto, consultando la deuda de {customer_name}...
    metadata:
      variables:
        required:
          - customer_name

  - key: pharmacy.fallback.unclear_selection
    name: Unclear Selection
    description: Selecci√≥n no clara
    version: "1.0.0"
    template: |
      No pude identificar tu selecci√≥n.
      Por favor indica un n√∫mero del 1 al {max_option}, o escribe el nombre o DNI de la persona.
    metadata:
      variables:
        required:
          - max_option

  # =========================================================================
  # CONSULTA DE DEUDA (DebtCheckNode)
  # =========================================================================

  - key: pharmacy.fallback.debt_query
    name: Debt Query Fallback
    description: Mostrar deuda cuando LLM falla
    version: "1.0.0"
    template: |
      **Consulta de Deuda**

      Hola {customer_name},

      Tu deuda pendiente es de **{total_debt}**

      Para confirmar y proceder con el pago, responde *SI*.
      Para cancelar, responde *NO*.
    metadata:
      variables:
        required:
          - customer_name
          - total_debt

  - key: pharmacy.fallback.no_customer
    name: No Customer Identified
    description: Cliente no identificado
    version: "1.0.0"
    template: |
      No pude identificar tu cuenta.
      Por favor escribe tu n√∫mero de DNI para buscarte.
    metadata:
      variables:
        required: []

  - key: pharmacy.fallback.partial_payment_offer
    name: Partial Payment Offer
    description: Oferta de pago parcial
    version: "1.0.0"
    template: |
      Entendido. ¬øTe gustar√≠a hacer un **pago parcial** de tu deuda?

      Tu deuda total es **{total_debt}**.
      Puedes pagar cualquier monto desde **{min_payment}**.

      ¬øQuer√©s realizar un pago parcial? Responde *SI* o *NO*.
    metadata:
      variables:
        required:
          - total_debt
          - min_payment

  - key: pharmacy.fallback.amount_request
    name: Amount Request
    description: Solicitar monto de pago
    version: "1.0.0"
    template: |
      Perfecto. ¬øCu√°nto deseas pagar?

      Tu deuda total: **{total_debt}**
      Monto m√≠nimo: **{min_payment}**

      Escribe el monto que deseas abonar (ej: *5000* o *pagar 5000*).
    metadata:
      variables:
        required:
          - total_debt
          - min_payment

  - key: pharmacy.fallback.invalid_amount_input
    name: Invalid Amount Input
    description: Monto inv√°lido ingresado
    version: "1.0.0"
    template: |
      No pude identificar el monto.
      Por favor escribe la cantidad que deseas pagar (ej: *5000*).

      Monto m√≠nimo: **{min_payment}**
    metadata:
      variables:
        required:
          - min_payment

  - key: pharmacy.fallback.amount_below_minimum
    name: Amount Below Minimum
    description: Monto por debajo del m√≠nimo
    version: "1.0.0"
    template: |
      El monto m√≠nimo de pago es **{min_payment}**.

      Por favor ingresa un monto igual o mayor.
    metadata:
      variables:
        required:
          - min_payment

  - key: pharmacy.fallback.amount_above_debt
    name: Amount Above Debt
    description: Monto superior a la deuda
    version: "1.0.0"
    template: |
      El monto ingresado ({amount}) es mayor a tu deuda ({total_debt}).

      Por favor ingresa un monto igual o menor a tu deuda.
    metadata:
      variables:
        required:
          - amount
          - total_debt

  - key: pharmacy.fallback.payment_confirmed
    name: Payment Confirmed
    description: Pago confirmado
    version: "1.0.0"
    template: |
      Perfecto {customer_name}, generando link de pago por **{amount}**.
    metadata:
      variables:
        required:
          - customer_name
          - amount

  - key: pharmacy.fallback.partial_payment_confirmed
    name: Partial Payment Confirmed
    description: Pago parcial confirmado
    version: "1.0.0"
    template: |
      Perfecto {customer_name}, generando link de pago por **{amount}**.

      Saldo restante despu√©s del pago: **{remaining}**
    metadata:
      variables:
        required:
          - customer_name
          - amount
          - remaining

  - key: pharmacy.fallback.payment_declined
    name: Payment Declined
    description: Pago rechazado
    version: "1.0.0"
    template: |
      Entendido {customer_name}. Tu deuda de **{total_debt}** queda pendiente.

      ¬øHay algo m√°s en que pueda ayudarte?
    metadata:
      variables:
        required:
          - customer_name
          - total_debt

  - key: pharmacy.fallback.unclear_confirmation
    name: Unclear Confirmation
    description: Confirmaci√≥n no clara
    version: "1.0.0"
    template: |
      Disculpa {customer_name}, no entend√≠ tu respuesta.
      ¬øDeseas confirmar el pago? Responde *SI* o *NO*.
    metadata:
      variables:
        required:
          - customer_name

  # =========================================================================
  # CONFIRMACI√ìN (ConfirmationNode)
  # =========================================================================

  - key: pharmacy.fallback.confirmation_cancelled
    name: Confirmation Cancelled
    description: Confirmaci√≥n cancelada
    version: "1.0.0"
    template: |
      Entendido, la confirmaci√≥n ha sido cancelada.

      ¬øHay algo m√°s en que pueda ayudarte?
    metadata:
      variables:
        required: []

  - key: pharmacy.fallback.request_clear_confirmation
    name: Request Clear Confirmation
    description: Solicitar confirmaci√≥n clara
    version: "1.0.0"
    template: |
      Por favor responde *SI* para confirmar tu deuda o *NO* para cancelar.
    metadata:
      variables:
        required: []

  - key: pharmacy.fallback.auto_fetching_debt
    name: Auto Fetching Debt
    description: Consultando deuda autom√°ticamente
    version: "1.0.0"
    template: |
      Espera un momento, te voy a mostrar tu deuda...
    metadata:
      variables:
        required: []

  - key: pharmacy.fallback.confirmation_no_customer
    name: Confirmation No Customer
    description: Sin cliente para confirmar
    version: "1.0.0"
    template: |
      No pude identificar tu cuenta.
      Por favor contacta a soporte para asistencia.
    metadata:
      variables:
        required: []

  - key: pharmacy.fallback.confirmation_error
    name: Confirmation Error
    description: Error en confirmaci√≥n
    version: "1.0.0"
    template: |
      Disculpa, tuve un problema procesando la confirmaci√≥n.
      Por favor intenta de nuevo.
    metadata:
      variables:
        required: []

  - key: pharmacy.fallback.debt_confirmed_full
    name: Debt Confirmed Full
    description: Deuda confirmada (pago total)
    version: "1.0.0"
    template: |
      Tu deuda de **{total_debt}** ha sido confirmada.

      Generando link de pago...
    metadata:
      variables:
        required:
          - total_debt

  - key: pharmacy.fallback.debt_confirmed_partial
    name: Debt Confirmed Partial
    description: Deuda confirmada (pago parcial)
    version: "1.0.0"
    template: |
      Tu pago parcial de **{payment_amount}** ha sido confirmado.

      **Resumen:**
      - Deuda total: {total_debt}
      - Monto a pagar: {payment_amount}
      - Saldo pendiente: {remaining_balance}

      Generando link de pago...
    metadata:
      variables:
        required:
          - payment_amount
          - total_debt
          - remaining_balance

  # =========================================================================
  # ERRORES GEN√âRICOS
  # =========================================================================

  - key: pharmacy.fallback.generic_error
    name: Generic Error
    description: Error gen√©rico
    version: "1.0.0"
    template: |
      Tuve un problema procesando tu solicitud.
      Por favor intenta de nuevo.
    metadata:
      variables:
        required: []

  - key: pharmacy.fallback.max_errors_reached
    name: Max Errors Reached
    description: M√°ximo de errores alcanzado
    version: "1.0.0"
    template: |
      Tuve varios problemas.
      Por favor contacta a la farmacia directamente.
    metadata:
      variables:
        required: []

  # =========================================================================
  # REGISTRO DE CLIENTES (CustomerRegistrationNode)
  # =========================================================================

  - key: pharmacy.fallback.registration_yes_no_validation
    name: Registration Yes/No Validation
    description: Solicitar confirmaci√≥n SI/NO para registro
    version: "1.0.0"
    template: |
      Por favor responde *SI* para {action} o *NO* para {cancel_action}.
    metadata:
      variables:
        required:
          - action
          - cancel_action

  - key: pharmacy.fallback.registration_start
    name: Registration Start
    description: Inicio del registro
    version: "1.0.0"
    template: |
      Perfecto, vamos a registrarte.

      Por favor, ingresa tu nombre completo:
    metadata:
      variables:
        required: []

  - key: pharmacy.fallback.registration_name_error
    name: Registration Name Error
    description: Error en nombre de registro
    version: "1.0.0"
    template: |
      El nombre ingresado es muy corto.
      Por favor ingresa tu nombre completo (m√≠nimo 3 caracteres):
    metadata:
      variables:
        required: []

  - key: pharmacy.fallback.registration_document_prompt
    name: Registration Document Prompt
    description: Solicitar documento para registro
    version: "1.0.0"
    template: |
      Ahora ingresa tu n√∫mero de documento (DNI):
    metadata:
      variables:
        required: []

  - key: pharmacy.fallback.registration_document_error
    name: Registration Document Error
    description: Error en documento de registro
    version: "1.0.0"
    template: |
      El documento ingresado no es v√°lido.
      Por favor ingresa solo n√∫meros (entre 6 y 11 d√≠gitos):
    metadata:
      variables:
        required: []

  - key: pharmacy.fallback.registration_confirm_data
    name: Registration Confirm Data
    description: Confirmar datos de registro
    version: "1.0.0"
    template: |
      Por favor confirma tus datos:

      **Nombre:** {nombre}
      **Documento:** {documento}

      ¬øEs correcto? Responde *SI* para confirmar o *NO* para cancelar.
    metadata:
      variables:
        required:
          - nombre
          - documento

  - key: pharmacy.fallback.registration_success
    name: Registration Success
    description: Registro exitoso
    version: "1.0.0"
    template: |
      ¬°{customer_name}, tu registro fue exitoso!

      Ya puedes consultar tu deuda y generar links de pago.
      ¬øEn qu√© puedo ayudarte?
    metadata:
      variables:
        required:
          - customer_name

  - key: pharmacy.fallback.registration_duplicate_with_name
    name: Registration Duplicate With Name
    description: Cliente duplicado con nombre
    version: "1.0.0"
    template: |
      {customer_name}, ya ten√©s una cuenta registrada.

      ¬øEn qu√© puedo ayudarte?
    metadata:
      variables:
        required:
          - customer_name

  - key: pharmacy.fallback.registration_duplicate_no_name
    name: Registration Duplicate No Name
    description: Documento ya registrado
    version: "1.0.0"
    template: |
      Ese documento ya est√° registrado en el sistema.
      Por favor contacta a la farmacia para m√°s informaci√≥n.
    metadata:
      variables:
        required: []

  - key: pharmacy.fallback.registration_not_supported
    name: Registration Not Supported
    description: Registro no disponible
    version: "1.0.0"
    template: |
      El registro de nuevos clientes no est√° disponible en este momento.
      Por favor contacta directamente a la farmacia.
    metadata:
      variables:
        required: []

  - key: pharmacy.fallback.registration_error
    name: Registration Error
    description: Error en registro
    version: "1.0.0"
    template: |
      Hubo un error al procesar tu registro: {error}
      Por favor contacta a la farmacia para asistencia.
    metadata:
      variables:
        required:
          - error

  - key: pharmacy.fallback.registration_cancelled
    name: Registration Cancelled
    description: Registro cancelado
    version: "1.0.0"
    template: |
      Entendido, el registro ha sido cancelado.

      ¬øHay algo m√°s en que pueda ayudarte?
    metadata:
      variables:
        required: []

  - key: pharmacy.fallback.registration_exception
    name: Registration Exception
    description: Error inesperado en registro
    version: "1.0.0"
    template: |
      Tuve un problema procesando tu registro.
      Por favor intenta de nuevo.
    metadata:
      variables:
        required: []

  # =========================================================================
  # CONSULTA DE DATOS (DataQueryHandler)
  # =========================================================================

  - key: pharmacy.fallback.data_query_no_data
    name: Data Query No Data
    description: Sin datos para consulta
    version: "1.0.0"
    template: |
      Hola {customer_name}, no tengo informaci√≥n de tu cuenta para responder esa pregunta.

      Por favor escribe *deuda* para consultar tu saldo pendiente.
    metadata:
      variables:
        required:
          - customer_name

  - key: pharmacy.fallback.data_query_analyze
    name: Data Query Analyze
    description: An√°lisis de datos de deuda
    version: "1.0.0"
    template: |
      **{customer_name}**, aqu√≠ est√° la informaci√≥n de tu cuenta:

      üì¶ **Total:** {total_debt}
      üìÑ **Facturas:** {invoice_count}

      {debt_details}

      ¬øNecesitas m√°s detalles? Escribe *deuda* para ver el listado completo.
    metadata:
      variables:
        required:
          - customer_name
          - total_debt
          - invoice_count
          - debt_details

  # =========================================================================
  # INFORMACI√ìN DE FARMACIA (PharmacyInfoHandler)
  # =========================================================================

  - key: pharmacy.fallback.info_query_capability
    name: Info Query Capability
    description: Explicar capacidades del bot
    version: "1.0.0"
    template: |
      ¬°Hola {customer_name}! Soy tu asistente virtual de {pharmacy_name}.

      **Puedo ayudarte con:**
      ‚Ä¢ **Consultar tu deuda** - Te muestro cu√°nto debes actualmente
      ‚Ä¢ **Generar link de pago** - Para que pagues tu deuda de forma f√°cil
      ‚Ä¢ **Pagos parciales** - Si quieres abonar una parte de tu deuda
      ‚Ä¢ **Informaci√≥n de la farmacia** - Direcci√≥n, tel√©fono, horarios

      Solo escr√≠beme lo que necesitas.

      ¬øEn qu√© puedo ayudarte hoy?
    metadata:
      variables:
        required:
          - customer_name
          - pharmacy_name

  - key: pharmacy.fallback.info_query_no_info
    name: Info Query No Info
    description: Sin informaci√≥n de farmacia
    version: "1.0.0"
    template: |
      Disculpa {customer_name}, no tengo acceso a la informaci√≥n de contacto de {pharmacy_name} en este momento.

      Por favor, intenta comunicarte por otro medio.
    metadata:
      variables:
        required:
          - customer_name
          - pharmacy_name

  - key: pharmacy.fallback.info_query_generate
    name: Info Query Generate
    description: Informaci√≥n de farmacia
    version: "1.0.0"
    template: |
      **Informaci√≥n de {pharmacy_name}:**

      üìç **Direcci√≥n:** {pharmacy_address}
      üìû **Tel√©fono:** {pharmacy_phone}
      ‚úâÔ∏è **Email:** {pharmacy_email}
      üåê **Web:** {pharmacy_website}

      **Horario:**
      {pharmacy_hours}
    metadata:
      variables:
        required:
          - pharmacy_name
          - pharmacy_address
          - pharmacy_phone
          - pharmacy_email
          - pharmacy_website
          - pharmacy_hours

  # =========================================================================
  # RESUMEN (SummaryHandler)
  # =========================================================================

  - key: pharmacy.fallback.summary_no_data
    name: Summary No Data
    description: Sin datos para resumen
    version: "1.0.0"
    template: |
      Hola {customer_name}, no tengo informaci√≥n de productos para resumir.

      Primero necesito que consultes tu deuda. Escribe *deuda* o *cu√°nto debo*.
    metadata:
      variables:
        required:
          - customer_name

  - key: pharmacy.fallback.summary_generate
    name: Summary Generate
    description: Resumen de deuda
    version: "1.0.0"
    template: |
      **Resumen de tu cuenta, {customer_name}**

      üì¶ **Productos:** {item_count}
      üí∞ **Total:** {total_debt}

      {items_list}

      Para ver el detalle completo, escribe *deuda*.
    metadata:
      variables:
        required:
          - customer_name
          - item_count
          - total_debt
          - items_list

  # =========================================================================
  # DESAMBIGUACI√ìN (DisambiguationHandler)
  # =========================================================================

  - key: pharmacy.fallback.request_dni_disambiguation
    name: Request DNI Disambiguation
    description: Solicitar DNI para desambiguaci√≥n
    version: "1.0.0"
    template: |
      Entendido. Por favor ingresa tu n√∫mero de documento (DNI):
    metadata:
      variables:
        required: []

  # =========================================================================
  # IDENTIFICACI√ìN (IdentificationResponseHandler)
  # =========================================================================

  - key: pharmacy.fallback.out_of_scope_identified
    name: Out of Scope Identified
    description: Fuera de alcance para cliente identificado
    version: "1.0.0"
    template: |
      Esa consulta est√° fuera de mi alcance.

      Solo puedo ayudarte con deudas y pagos.
      Para otros temas, contacta a {pharmacy_phone}.
    metadata:
      variables:
        required:
          - pharmacy_phone

  - key: pharmacy.fallback.out_of_scope_not_identified
    name: Out of Scope Not Identified
    description: Fuera de alcance para cliente no identificado
    version: "1.0.0"
    template: |
      Esa consulta est√° fuera de mi alcance.

      Solo puedo ayudarte con deudas y pagos.
      Para otros temas, contacta a {pharmacy_phone}.

      **¬øQuieres usar nuestros servicios?**
      Puedo ayudarte con consulta de deuda y links de pago.
      Solo necesito tu DNI o numero de cliente para identificarte.
    metadata:
      variables:
        required:
          - pharmacy_phone

  - key: pharmacy.fallback.welcome_message
    name: Welcome Message
    description: Mensaje de bienvenida
    version: "1.0.0"
    template: |
      ¬°Hola! Soy el asistente virtual de {pharmacy_name}.

      Puedo ayudarte con:
      ‚Ä¢ Consulta de deuda en cuenta corriente
      ‚Ä¢ Env√≠o de link de pago

      Para consultar tu deuda, necesito que me proporciones tu n√∫mero de cliente o documento de identidad.

      Por favor, env√≠alo en el siguiente formato:
      ‚Ä¢ Cliente: [tu n√∫mero]
      o
      ‚Ä¢ DNI: [tu documento]

      Tu informaci√≥n ser√° tratada de forma confidencial.
    metadata:
      variables:
        required:
          - pharmacy_name

  - key: pharmacy.fallback.registration_offer
    name: Registration Offer
    description: Oferta de registro
    version: "1.0.0"
    template: |
      No encontr√© una cuenta con esos datos.
      ¬øTe gustar√≠a registrarte como nuevo cliente?

      Responde *SI* para registrarte o *NO* para salir.
    metadata:
      variables:
        required: []

  - key: pharmacy.fallback.invalid_document
    name: Invalid Document
    description: Documento inv√°lido
    version: "1.0.0"
    template: |
      El n√∫mero de documento ingresado no parece v√°lido.
      Por favor ingresa tu DNI (solo n√∫meros, m√≠nimo 6 d√≠gitos):
    metadata:
      variables:
        required: []

  - key: pharmacy.fallback.document_reminder
    name: Document Reminder
    description: Recordatorio de documento
    version: "1.0.0"
    template: |
      Entiendo que quieres realizar esa acci√≥n, pero primero necesito identificarte.

      Por favor, proporcioname tu n√∫mero de DNI o documento de identidad (7-8 d√≠gitos) para poder continuar.
    metadata:
      variables:
        required: []
