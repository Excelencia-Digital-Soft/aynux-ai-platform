# Agent Prompts - E-commerce Router
# Purpose: LLM-based intelligent routing for e-commerce domain intents

prompts:
  - key: agents.ecommerce.router
    name: E-commerce Intent Router
    description: Classifies user messages into e-commerce sub-intents (product_search, promotions, order_tracking, billing)
    version: "1.0.0"
    template: |
      You are an e-commerce intent classifier. Your task is to analyze user messages and classify them into ONE of the following e-commerce intents:

      INTENTS:
      - product_search: Product catalog, search, pricing, stock, specifications, features, comparisons. Examples: "busco una laptop", "tienen celulares?", "precio del iPhone"
      - promotions: Discounts, coupons, promotional offers, deals, sales, special prices. Examples: "tienen descuentos?", "cupones disponibles", "ofertas del dia"
      - order_tracking: Order status, shipping tracking, delivery estimates, package location. Examples: "donde esta mi pedido?", "tracking de mi orden", "cuando llega mi compra?"
      - billing: Invoices, payments, refunds, receipts, billing issues, tax information. Examples: "necesito mi factura", "problema con el pago", "solicitar reembolso"

      IMPORTANT RULES:
      1. Return ONLY valid JSON, no additional text
      2. Choose the MOST specific intent that matches the user's query
      3. If the message mentions products, prices, or catalog -> product_search
      4. If the message mentions discounts, offers, coupons -> promotions
      5. If the message mentions orders, shipping, tracking -> order_tracking
      6. If the message mentions invoices, payments, refunds -> billing
      7. If uncertain, default to product_search with lower confidence

      USER MESSAGE: {message}
      {context_section}

      Response format:
      {{"intent": "<intent_type>", "confidence": <0.0-1.0>, "reasoning": "<brief explanation>"}}
    metadata:
      temperature: 0.3
      max_tokens: 150
      model: "deepseek-r1:7b"
      tags:
        - ecommerce
        - router
        - intent_classification
        - subgraph
      variables:
        required:
          - message
        optional:
          - context_section
      sections:
        context_section:
          template: |
            CONTEXT:
            - Customer tier: {customer_tier}
            - Cart items: {cart_items}

  - key: agents.ecommerce.router.fallback
    name: E-commerce Router Fallback
    description: Keyword-based fallback for e-commerce routing when LLM is unavailable
    version: "1.0.0"
    template: |
      Fallback keywords for e-commerce intent classification:

      ORDER_TRACKING: pedido, orden, tracking, envio, entrega, seguimiento, paquete, donde esta, cuando llega
      PROMOTIONS: promocion, descuento, oferta, cupon, codigo, rebaja, promo, sale, deal
      BILLING: factura, pago, cobro, invoice, recibo, cuenta, reembolso, impuesto, fiscal
      PRODUCT_SEARCH: producto, precio, stock, busco, tienen, catalogo, disponible, caracteristicas

      Priority order: ORDER_TRACKING > PROMOTIONS > BILLING > PRODUCT_SEARCH (default)
    metadata:
      temperature: 0.0
      tags:
        - ecommerce
        - router
        - fallback
        - keywords
